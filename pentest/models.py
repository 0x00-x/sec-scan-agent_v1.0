#!/usr/bin/env python
#coding:utf-8
#__author__:Bing
#email:amazing_bing@outlook.com

from django.db import models

class UserInfo(models.Model):
    username = models.CharField(max_length=30)
    password = models.CharField(max_length=50)
    email = models.EmailField()
    phone = models.BigIntegerField()
    ip = models.GenericIPAddressField()
    agent = models.TextField()
    register_date = models.DateTimeField()
    user_hash = models.CharField(max_length=33,null=True)
    permiss = models.ForeignKey('UserGroup')
    company_user = models.ManyToManyField('UserCompany')
    
class UserCompany(models.Model):
    tname = models.CharField(max_length=16)
    
class UserGroup(models.Model):
    gname = models.CharField(max_length=16)

class UserLogin(models.Model):
    login_date = models.DateTimeField()
    login_ip = models.GenericIPAddressField()
    login_agent = models.TextField()
    login_name = models.ForeignKey('UserInfo')
    
class ScanConfig(models.Model):
    host = models.CharField(max_length=80)
    scan_model = ((0,'xss'),(1,'sql'),(2,'ssrf'),(3,'code excute'),(4,'lfi'))
    model = models.IntegerField(choices=scan_model,null=True)
    plugin = models.TextField()
    status = models.IntegerField()
    #user_host = models.ForeignKey("UserInfo")
    
class ScanResult(models.Model):
    host_info = models.TextField()
    host_result = models.TextField()
    host_repair = models.TextField()
    host_name = models.ForeignKey("ScanConfig")
    
class SancPlugin(models.Model):
    #status = models.IntegerField(max_length=2)
    pass

class ScanSource(models.Model):
    #host,post/get,status
    pass
    
    